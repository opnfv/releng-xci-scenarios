##############################################################################
# Copyright (c) 2018 Ericsson and others.
#
# All rights reserved. This program and the accompanying materials
# are made available under the terms of the Apache License, Version 2.0
# which accompanies this distribution, and is available at
# http://www.apache.org/licenses/LICENSE-2.0
##############################################################################
---

- name: Clone the Ansible-OpenDaylight repository
  git:
    repo: https://github.com/opendaylight/integration-packaging-ansible-opendaylight
    dest: /etc/ansible/roles/opendaylight
    version: master
- name: copy k8s-cluster.yml
  copy:
    src: "k8s-cluster.yml"
    dest: "{{ remote_xci_path }}/.cache/repos/kubespray/opnfv_inventory/group_vars/k8s-cluster.yml"
- name: Setting ODL repo version if required
  set_fact:
    odl_version: "{{ odl_repo_version }}"
  when: odl_repo_version is defined
- name: Include ODL role
  include_role:
    name: opendaylight
  vars:
    install_method: "{{ opendaylight_install_method }}"
    extra_features: "{{ opendaylight_extra_features }}"
    nb_rest_port: "{{ opendaylight_port | default('8180') }}"
